### Primes
**定义 1**
如果大于 1 的整数 $p$ 只有两个因子 1 和 $p$，那么 $p$ 是质数。大于 1 的非质数称为合数。

注意，1 不是质数，因为只有 1 一个因子。$n$ 是合数等价于存在一个 $a$ 使得 $a|n,1<a<n$。

**定理 1 算术基本定理**
每一个大于 1 的整数，要么是一个质数，要么能唯一的按照非递减序写成两个或者更多的质数之积。

### Trial Division
**定理 2**
如果 $n$ 是一个合数，那么存在一个质因数小于等于 $\sqrt{n}$。

证明：根据合数定义，存在一个 $a,1<a<n$ 是 $n$ 的因数，那么存在 $b,1<b<n$ 使得 $ab=n$。反证法。假设 $a,b$ 都大于 $\sqrt{n}$，那么 $ab>\sqrt{n}\sqrt{n}>n$，矛盾，所以至少存在一个因数小于等于 $\sqrt{n}$。不妨设 $a<b$，如果 $a$ 是质数，证明完成。如果 $a$ 是合数，根据算术基本定理，那么存在一个小于 $a$ 的质因数，证明完成。

根据定理 2，如果一个整数能够被小于等于它的所有质数整除，那么这个整数是质数。这个判断一个数是否是质数的方法称为试除法。

下面的过程可以用于找到一个整数的质因数。从最小的质数 2 开始使用各个质数试除 $n$。如果 $n$ 包含质因数，那么根据定理 2 存在一个不超过 $\sqrt{n}$ 的质数 $p$ 能够整数 $n$。如果找到到这样的 $p$，说明 $n$ 是质数，结束整个过程；否则继续寻找 $n/p$ 的质因数。注意，$n/p$ 不存在比 $p$ 小的质因数，所以这里从 $p$ 开始即可。

### The Sieve of Eratosthenes
埃拉托斯特尼筛法用于找到所有不超过指定的某个整数的所有质数。从 2 开始，将比 2 大且能被 2 整除的数都删除。下一个没有被删除的数是质数，这里是 3，然后将比 3 大且能被 3 整除的数都删除。下一个没有被删除的数是质数，是 5。依次类推。

很早之前人们就意识到质数无穷多。给定前 $n$ 小的质数 $p_1,p_2,\cdots,p_n$，存在一个更大的质数不在此列。欧几里得就给出一个非常优雅的证明。

**定理 3**
存在无数个质数。

证明：反证法。假设只有有限多个质数 $p_1,p_2,\cdots,p_n$，令
$$Q=p_1p_2\cdots p_n+1$$
根据算术基本定理，$Q$ 是质数或者是能分解成两个或多个质数的乘积。假定存在某个 $p_j|Q$，那么 $p_j$ 能被 $Q-p_1p_2\cdots p_n=1$ 整除，出现了矛盾，那么 $p_j$ 都不能整除 $Q$。这时一定存在一个不在列表中的质数，这么质数要么是 $Q$ 要么是 $Q$ 的某个质因数。这与我们假定的有有限多个质数矛盾。

注意，整个证明过程并没有证明 $Q$ 是一个质数。我们给出的是非构造性的存在证明，只是说存在某个质数不在假定的列表中。

由于质数无限多，所以给定一个整数，一定存在一个大于它的质数。现在已知的最大的质数形式是 $2^p-1$，注意这里 $p$ 是质数。这样形式的质数称为梅森素数（`Mersenne primes`）。卢卡斯-莱默检验法（`Lucas-Lehmer test`）可以快速检验这个形式的数是否是质数。不过没有其他同样快的算法能够检查其他形式的数是否是质数。

形式是 $2^n-1$ 的数不是质数。分两种情况考虑。当 $n=2k$ 时，可以分解因式 $(2^k+1)(2^k-1)$，当 $n=2k+1$ 时，也可以分解因式 $(x-1)(x^{n-1}+x^{n-2}+\cdots+1)x$。

质数有无限多，那么小于 $x$ 的质数有多少个呢？

**定理 4 质数定理**
当 $x$ 趋于无穷时，不超过 $x$ 的质数个数 $\pi(x)$ 与 $x/\ln x$ 趋于 1。

所有已知的证明都比较复杂。

下表给出了
